CREATE DATABASE DEMO_DATABASE;

USE DATABASE DEMO_DATABASE;

CREATE OR REPLACE TABLE JD_CUSTOMER_NAME
(
Customer_Index int PRIMARY KEY,
CustomerNames varchar(40));

CREATE OR REPLACE TABLE JD_REGIONS
(
RegionIndex int PRIMARY KEY,
City varchar(40),
Country varchar(40));

CREATE OR REPLACE TABLE JD_PRODUCTS
(
ProductIndex int PRIMARY KEY,
Product_Name varchar(40));

CREATE OR REPLACE TABLE JD_SALES_ORDER 
(
ORDERNUMBER VARCHAR (15),
ORDERDATE VARCHAR(20),
CUSTOMER_INDEX INT PRIMARY KEY,
CHANNEL VARCHAR (15),
WAREHOUSE_CODE VARCHAR (15),
DELIVERY_REGION_INDEX INT NOT NULL,
PRODUCT_INDEX INT FOREIGN KEY REFERENCES JD_PRODUCTS(ProductIndex),
ORDER_QTY INT,
UNIT_PRICE_USD NUMBER(7,2),
TOTAL_REVENUE_USD NUMBER (7,2),
TOTAL_UNIT_PRICE NUMBER(7,2));
  
SELECT * FROM JD_CUSTOMER_NAME;
SELECT * FROM JD_REGIONS;
SELECT * FROM JD_PRODUCTS;
SELECT * FROM  JD_SALES_ORDER;
  
DROP VIEW  JD_CUST_SALES_ORDER_VW;
  
CREATE OR REPLACE TABLE JD_CUST_SALES_ORDER_TBL AS
  SELECT A.*,B.PRODUCT_NAME ,C.CITY,C.COUNTRY,C.CITY||'-'||C.COUNTRY AS FULL_NAME ,D.CUSTOMERNAMES
  FROM JD_SALES_ORDER A
  LEFT OUTER JOIN JD_PRODUCTS B ON A.PRODUCT_INDEX = B.PRODUCTINDEX
  LEFT OUTER JOIN JD_REGIONS C ON A.DELIVERY_REGION_INDEX = C.REGIONINDEX
  LEFT OUTER JOIN JD_CUSTOMER_NAME D ON A.CUSTOMER_INDEX  = D.CUSTOMER_INDEX;
  
DESCRIBE TABLE  JD_CUST_SALES_ORDER_TBL;
  
--SELECT TO_CHAR(ORDERDATE,'DD-MM-YYYY') AS DATE

  
SELECT * FROM   JD_CUST_SALES_ORDER_TBL;

SELECT TO_DATE( ORDERDATE, 'DD-MM-YYYY' ) AS DATE
FROM JD_CUST_SALES_ORDER_TBL